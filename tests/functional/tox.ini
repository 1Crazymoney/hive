[tox]
envlist = py36, beem_dhf, hived_hybrid_operations, list_proposals, hived_options
skipsdist = true

[testenv]
setenv = 
  PYTHONPATH = {env:PYTHONPATH:}:{toxinidir}/hive_utils
passenv =
  CI_PROJECT_DIR
deps = 
  python-dateutil
  junit_xml
  secp256k1prp
  git+https://gitlab.syncad.com/hive/beem.git@dk-hybrid-operations#egg=beem
platform = 
  linux
whitelist_externals =
  mkdir
  screen
  hived
commands =
  {envpython} --version

[testenv:beem_dhf]
changedir = 
  {toxinidir}/python_tests/dhf_tests
commands = 
  {[testenv]commands}
  mkdir -p {env:CI_PROJECT_DIR}/build/tests/hive-node-data
  {envpython} beem_dhf_tests.py initminer initminer 5JNHfZYKGaomSFvd4NUdQ9qMcEAC43kujbfjueTHpVapX1Kzq2n --run-hived {env:CI_PROJECT_DIR}/testnet_node_build/install-root/bin/hived --working-dir={env:CI_PROJECT_DIR}/build/tests/hive-node-data --no-erase-proposal --junit-output=beem_dhf_test.xml

[testenv:hived_hybrid_operations]
changedir = 
  {toxinidir}/python_tests/hived
commands = 
  {[testenv]commands}
  mkdir -p {env:CI_PROJECT_DIR}/build/tests/hive-node-data
  {envpython} hived_hybrid_operations_test.py initminer 5JNHfZYKGaomSFvd4NUdQ9qMcEAC43kujbfjueTHpVapX1Kzq2n --run-hived {env:CI_PROJECT_DIR}/testnet_node_build/install-root/bin/hived --working-dir={env:CI_PROJECT_DIR}/build/tests/hive-node-data

[testenv:list_proposals]
changedir = 
  {toxinidir}/python_tests/dhf_tests
commands = 
  {[testenv]commands}
  mkdir -p {env:CI_PROJECT_DIR}/build/tests/hive-node-data
  {envpython} list_proposals_tests.py initminer initminer 5JNHfZYKGaomSFvd4NUdQ9qMcEAC43kujbfjueTHpVapX1Kzq2n --run-hived {env:CI_PROJECT_DIR}/testnet_node_build/install-root/bin/hived --working-dir={env:CI_PROJECT_DIR}/build/tests/hive-node-data --junit-output=list_proposals_tests.xml

[testenv:hived_options]
changedir = 
  {toxinidir}/python_tests/hived
commands = 
  {[testenv]commands}
  {envpython} hived_options_tests.py --run-hived {env:CI_PROJECT_DIR}/testnet_node_build/install-root/bin/hived